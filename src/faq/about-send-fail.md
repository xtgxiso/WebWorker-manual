# status里send_fail原因
**现象：**

运行status命令，看到有send_fail的情况，是什么原因？

**答：**

有send_fail通常来说不是什么大问题，一般是由于客户端主动关闭连接或者客户端停止接收数据导致的数据发送失败。

send_fail有两种原因

1、调用send接口向客户端发送数据时发现客户端已经断开，则send_fail计数加1。由于是客户端主动断开的，属于正常现象，一般可以忽略。

2、客户端接收缓冲区满（一般是由于客户端停止读取socket数据导致），但是服务端仍然调用send接口向客户端发送数据，导致数据积压在服务端数据发送缓冲区中（workerman为每个客户端建立了一个发送缓冲区），如果缓冲区大小超过限值（TcpConnection::$maxSendBufferSize默认1M）则会被丢弃，触发onError事件（如果有的话），并导致send_fail计数加1。

例如浏览器最小化后js一般会停止运行，浏览器不再读取服务端给它发送的websocket数据，如果服务端不断的向这个浏览器发送数据，这将导致数据积压在workerman的发送缓冲区，当缓冲数据达到上限值后，再调用send接口向客户端发送数据，则会触发onError，并且send_fail计数加1。

**总结：**

send_fail一般都是由客户端引起，一般来说由于浏览器断开导致的send_fail一般不用担心。如果是由于客户端停止接收数据导致的send_fail需要检查下客户端是否正常。
